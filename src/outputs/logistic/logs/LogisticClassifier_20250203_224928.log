2025-02-03 22:49:28,286 - LogisticClassifier - INFO - Logging initialized. Log file: outputs/logistic/logs/LogisticClassifier_20250203_224928.log
2025-02-03 22:49:28,291 - LogisticClassifier - INFO - Starting model training pipeline...
2025-02-03 22:49:28,291 - LogisticClassifier - INFO - Performing initial train-test split...
2025-02-03 22:49:29,164 - LogisticClassifier - INFO - 
Data Split Information:
2025-02-03 22:49:29,164 - LogisticClassifier - INFO - Training set size: 185659
2025-02-03 22:49:29,164 - LogisticClassifier - INFO - Test set size: 46415
2025-02-03 22:49:29,165 - LogisticClassifier - INFO - Training class distribution:
suicide        0.500003
non-suicide    0.499997
Name: proportion, dtype: float64
2025-02-03 22:49:29,165 - LogisticClassifier - INFO - Test class distribution:
non-suicide    0.500011
suicide        0.499989
Name: proportion, dtype: float64
2025-02-03 22:49:29,165 - LogisticClassifier - INFO - Starting cross-validation...
2025-02-03 22:49:29,260 - LogisticClassifier - INFO - 
Training fold 1/5
2025-02-03 22:49:29,294 - LogisticClassifier - DEBUG - Fold 0 sizes - Train: 148527, Val: 37132
2025-02-03 22:49:29,294 - LogisticClassifier - INFO - Training fold 1
2025-02-03 22:49:29,294 - LogisticClassifier - INFO - Training set size: 148527, Validation set size: 37132
2025-02-03 22:49:29,294 - LogisticClassifier - DEBUG - Original label types - Training: <class 'str'>, Validation: <class 'str'>
2025-02-03 22:49:29,349 - LogisticClassifier - DEBUG - Original unique labels - Training: ['non-suicide' 'suicide'], Validation: ['non-suicide' 'suicide']
2025-02-03 22:49:29,397 - LogisticClassifier - DEBUG - Final unique labels - Training: ['non-suicide' 'suicide'], Validation: ['non-suicide' 'suicide']
2025-02-03 22:49:29,397 - LogisticClassifier - INFO - Preprocessing training data...
2025-02-03 22:49:29,397 - LogisticClassifier - INFO - Number of texts: 148527
2025-02-03 22:49:29,398 - LogisticClassifier - INFO - Initializing and fitting TF-IDF vectorizer...
2025-02-03 22:49:36,734 - LogisticClassifier - INFO - Vocabulary size: 3000
2025-02-03 22:49:36,734 - LogisticClassifier - INFO - Preprocessing evaluation data...
2025-02-03 22:49:36,734 - LogisticClassifier - INFO - Number of texts: 37132
2025-02-03 22:49:38,617 - LogisticClassifier - INFO - Training Logistic Regression model...
2025-02-03 22:49:40,459 - LogisticClassifier - INFO - Fold 1 metrics: {'accuracy': 0.9341268986319078, 'precision': 0.9407743629005797, 'recall': 0.9265862328988473, 'f1': 0.9336263974818192, 'roc_auc': np.float64(0.9811838886976803)}
2025-02-03 22:49:40,464 - LogisticClassifier - INFO - Saved fold model to outputs/logistic/models/artifacts/logistic_model_fold_0_20250203_224928.joblib
2025-02-03 22:49:40,464 - LogisticClassifier - INFO - Fold 0 metrics: {'accuracy': 0.9341268986319078, 'precision': 0.9407743629005797, 'recall': 0.9265862328988473, 'f1': 0.9336263974818192, 'roc_auc': np.float64(0.9811838886976803), 'fold': 0}
2025-02-03 22:49:40,466 - LogisticClassifier - INFO - 
Training fold 2/5
2025-02-03 22:49:40,550 - LogisticClassifier - DEBUG - Fold 1 sizes - Train: 148527, Val: 37132
2025-02-03 22:49:40,550 - LogisticClassifier - INFO - Training fold 2
2025-02-03 22:49:40,550 - LogisticClassifier - INFO - Training set size: 148527, Validation set size: 37132
2025-02-03 22:49:40,550 - LogisticClassifier - DEBUG - Original label types - Training: <class 'str'>, Validation: <class 'str'>
2025-02-03 22:49:40,598 - LogisticClassifier - DEBUG - Original unique labels - Training: ['non-suicide' 'suicide'], Validation: ['non-suicide' 'suicide']
2025-02-03 22:49:40,646 - LogisticClassifier - DEBUG - Final unique labels - Training: ['non-suicide' 'suicide'], Validation: ['non-suicide' 'suicide']
2025-02-03 22:49:40,646 - LogisticClassifier - INFO - Preprocessing training data...
2025-02-03 22:49:40,646 - LogisticClassifier - INFO - Number of texts: 148527
2025-02-03 22:49:48,092 - LogisticClassifier - INFO - Preprocessing evaluation data...
2025-02-03 22:49:48,092 - LogisticClassifier - INFO - Number of texts: 37132
2025-02-03 22:49:49,932 - LogisticClassifier - INFO - Training Logistic Regression model...
2025-02-03 22:49:51,572 - LogisticClassifier - INFO - Fold 2 metrics: {'accuracy': 0.9327264892814823, 'precision': 0.9407988587731811, 'recall': 0.9235699666056232, 'f1': 0.9321048053924766, 'roc_auc': np.float64(0.9796989542297336)}
2025-02-03 22:49:51,574 - LogisticClassifier - INFO - Saved fold model to outputs/logistic/models/artifacts/logistic_model_fold_1_20250203_224928.joblib
2025-02-03 22:49:51,575 - LogisticClassifier - INFO - Fold 1 metrics: {'accuracy': 0.9327264892814823, 'precision': 0.9407988587731811, 'recall': 0.9235699666056232, 'f1': 0.9321048053924766, 'roc_auc': np.float64(0.9796989542297336), 'fold': 1}
2025-02-03 22:49:51,577 - LogisticClassifier - INFO - 
Training fold 3/5
2025-02-03 22:49:51,651 - LogisticClassifier - DEBUG - Fold 2 sizes - Train: 148527, Val: 37132
2025-02-03 22:49:51,651 - LogisticClassifier - INFO - Training fold 3
2025-02-03 22:49:51,651 - LogisticClassifier - INFO - Training set size: 148527, Validation set size: 37132
2025-02-03 22:49:51,651 - LogisticClassifier - DEBUG - Original label types - Training: <class 'str'>, Validation: <class 'str'>
2025-02-03 22:49:51,700 - LogisticClassifier - DEBUG - Original unique labels - Training: ['non-suicide' 'suicide'], Validation: ['non-suicide' 'suicide']
2025-02-03 22:49:51,748 - LogisticClassifier - DEBUG - Final unique labels - Training: ['non-suicide' 'suicide'], Validation: ['non-suicide' 'suicide']
2025-02-03 22:49:51,748 - LogisticClassifier - INFO - Preprocessing training data...
2025-02-03 22:49:51,748 - LogisticClassifier - INFO - Number of texts: 148527
2025-02-03 22:49:59,108 - LogisticClassifier - INFO - Preprocessing evaluation data...
2025-02-03 22:49:59,108 - LogisticClassifier - INFO - Number of texts: 37132
2025-02-03 22:50:00,987 - LogisticClassifier - INFO - Training Logistic Regression model...
2025-02-03 22:50:02,767 - LogisticClassifier - INFO - Fold 3 metrics: {'accuracy': 0.9308413228482172, 'precision': 0.9389266900790166, 'recall': 0.9216309382742648, 'f1': 0.9301984234846425, 'roc_auc': np.float64(0.9785989382492921)}
2025-02-03 22:50:02,770 - LogisticClassifier - INFO - Saved fold model to outputs/logistic/models/artifacts/logistic_model_fold_2_20250203_224928.joblib
2025-02-03 22:50:02,770 - LogisticClassifier - INFO - Fold 2 metrics: {'accuracy': 0.9308413228482172, 'precision': 0.9389266900790166, 'recall': 0.9216309382742648, 'f1': 0.9301984234846425, 'roc_auc': np.float64(0.9785989382492921), 'fold': 2}
2025-02-03 22:50:02,772 - LogisticClassifier - INFO - 
Training fold 4/5
2025-02-03 22:50:02,862 - LogisticClassifier - DEBUG - Fold 3 sizes - Train: 148527, Val: 37132
2025-02-03 22:50:02,862 - LogisticClassifier - INFO - Training fold 4
2025-02-03 22:50:02,862 - LogisticClassifier - INFO - Training set size: 148527, Validation set size: 37132
2025-02-03 22:50:02,862 - LogisticClassifier - DEBUG - Original label types - Training: <class 'str'>, Validation: <class 'str'>
2025-02-03 22:50:02,911 - LogisticClassifier - DEBUG - Original unique labels - Training: ['non-suicide' 'suicide'], Validation: ['non-suicide' 'suicide']
2025-02-03 22:50:02,960 - LogisticClassifier - DEBUG - Final unique labels - Training: ['non-suicide' 'suicide'], Validation: ['non-suicide' 'suicide']
2025-02-03 22:50:02,960 - LogisticClassifier - INFO - Preprocessing training data...
2025-02-03 22:50:02,960 - LogisticClassifier - INFO - Number of texts: 148527
2025-02-03 22:50:10,412 - LogisticClassifier - INFO - Preprocessing evaluation data...
2025-02-03 22:50:10,413 - LogisticClassifier - INFO - Number of texts: 37132
2025-02-03 22:50:12,272 - LogisticClassifier - INFO - Training Logistic Regression model...
2025-02-03 22:50:13,611 - LogisticClassifier - INFO - Fold 4 metrics: {'accuracy': 0.9349348271033071, 'precision': 0.9412086110807562, 'recall': 0.927825056554993, 'f1': 0.934468916133232, 'roc_auc': np.float64(0.9804558885444093)}
2025-02-03 22:50:13,614 - LogisticClassifier - INFO - Saved fold model to outputs/logistic/models/artifacts/logistic_model_fold_3_20250203_224928.joblib
2025-02-03 22:50:13,614 - LogisticClassifier - INFO - Fold 3 metrics: {'accuracy': 0.9349348271033071, 'precision': 0.9412086110807562, 'recall': 0.927825056554993, 'f1': 0.934468916133232, 'roc_auc': np.float64(0.9804558885444093), 'fold': 3}
2025-02-03 22:50:13,616 - LogisticClassifier - INFO - 
Training fold 5/5
2025-02-03 22:50:13,664 - LogisticClassifier - DEBUG - Fold 4 sizes - Train: 148528, Val: 37131
2025-02-03 22:50:13,665 - LogisticClassifier - INFO - Training fold 5
2025-02-03 22:50:13,665 - LogisticClassifier - INFO - Training set size: 148528, Validation set size: 37131
2025-02-03 22:50:13,665 - LogisticClassifier - DEBUG - Original label types - Training: <class 'str'>, Validation: <class 'str'>
2025-02-03 22:50:13,713 - LogisticClassifier - DEBUG - Original unique labels - Training: ['non-suicide' 'suicide'], Validation: ['non-suicide' 'suicide']
2025-02-03 22:50:13,761 - LogisticClassifier - DEBUG - Final unique labels - Training: ['non-suicide' 'suicide'], Validation: ['non-suicide' 'suicide']
2025-02-03 22:50:13,761 - LogisticClassifier - INFO - Preprocessing training data...
2025-02-03 22:50:13,761 - LogisticClassifier - INFO - Number of texts: 148528
2025-02-03 22:50:21,157 - LogisticClassifier - INFO - Preprocessing evaluation data...
2025-02-03 22:50:21,158 - LogisticClassifier - INFO - Number of texts: 37131
2025-02-03 22:50:23,751 - LogisticClassifier - INFO - Training Logistic Regression model...
2025-02-03 22:50:27,093 - LogisticClassifier - INFO - Fold 5 metrics: {'accuracy': 0.9323476340524091, 'precision': 0.9392579621319908, 'recall': 0.9244856188732091, 'f1': 0.9318132464712269, 'roc_auc': np.float64(0.9795813823687334)}
2025-02-03 22:50:27,097 - LogisticClassifier - INFO - Saved fold model to outputs/logistic/models/artifacts/logistic_model_fold_4_20250203_224928.joblib
2025-02-03 22:50:27,098 - LogisticClassifier - INFO - Fold 4 metrics: {'accuracy': 0.9323476340524091, 'precision': 0.9392579621319908, 'recall': 0.9244856188732091, 'f1': 0.9318132464712269, 'roc_auc': np.float64(0.9795813823687334), 'fold': 4}
2025-02-03 22:50:27,098 - LogisticClassifier - INFO - Best configuration from fold 4: {'max_iter': 1000, 'class_weight': 'balanced', 'vocab_size': 3000, 'fold': 3}
2025-02-03 22:50:27,098 - LogisticClassifier - INFO - Training final model on full training set...
2025-02-03 22:50:27,098 - LogisticClassifier - INFO - Training final model on complete training set...
2025-02-03 22:50:27,099 - LogisticClassifier - INFO - Training set size: 185659
2025-02-03 22:50:27,099 - LogisticClassifier - INFO - Preprocessing training data...
2025-02-03 22:50:27,099 - LogisticClassifier - INFO - Number of texts: 185659
2025-02-03 22:50:39,389 - LogisticClassifier - INFO - Fitting final model...
2025-02-03 22:50:41,016 - LogisticClassifier - INFO - Saved final model to outputs/logistic_model_final_20250203_224928.joblib
2025-02-03 22:50:41,016 - LogisticClassifier - INFO - Saved vectorizer to outputs/tfidf_vectorizer_20250203_224928.joblib
2025-02-03 22:50:41,118 - LogisticClassifier - INFO - Saved feature importance analysis to outputs/feature_importance_20250203_224928.csv
2025-02-03 22:50:41,120 - LogisticClassifier - INFO - Evaluating on held-out test set...
2025-02-03 22:50:41,120 - LogisticClassifier - INFO - Evaluating on test set...
2025-02-03 22:50:41,120 - LogisticClassifier - INFO - Test set size: 46415
2025-02-03 22:50:41,120 - LogisticClassifier - INFO - Preprocessing evaluation data...
2025-02-03 22:50:41,120 - LogisticClassifier - INFO - Number of texts: 46415
2025-02-03 22:50:43,820 - LogisticClassifier - INFO - Test set metrics: {'accuracy': 0.9330604330496607, 'precision': 0.94044175650802, 'recall': 0.9246778989098117, 'f1': 0.9324932102118414, 'roc_auc': np.float64(0.9808220988472868)}
2025-02-03 22:50:44,378 - LogisticClassifier - INFO - Final test metrics: {'accuracy': 0.9330604330496607, 'precision': 0.94044175650802, 'recall': 0.9246778989098117, 'f1': 0.9324932102118414, 'roc_auc': np.float64(0.9808220988472868)}
2025-02-03 22:50:44,392 - LogisticClassifier - INFO - Calculated aggregate metrics:
2025-02-03 22:50:44,392 - LogisticClassifier - INFO - accuracy: 0.9330 ± 0.0016
2025-02-03 22:50:44,392 - LogisticClassifier - INFO - precision: 0.9402 ± 0.0010
2025-02-03 22:50:44,392 - LogisticClassifier - INFO - recall: 0.9248 ± 0.0024
2025-02-03 22:50:44,392 - LogisticClassifier - INFO - f1: 0.9324 ± 0.0017
2025-02-03 22:50:44,392 - LogisticClassifier - INFO - roc_auc: 0.9799 ± 0.0010
2025-02-03 22:50:44,392 - LogisticClassifier - INFO - fold: 2.0000 ± 1.5811
2025-02-03 22:50:44,393 - LogisticClassifier - INFO - Saved fold results to outputs/logistic/metrics/LogisticClassifier_cv_fold_results_20250203_224928.csv
2025-02-03 22:50:44,394 - LogisticClassifier - INFO - Metrics saved to outputs/logistic/metrics/LogisticClassifier_test_20250203_224928.json
2025-02-03 22:50:44,394 - LogisticClassifier - INFO - Metrics saved to outputs/logistic/metrics/LogisticClassifier_cv_mean_20250203_224928.json
2025-02-03 22:50:44,394 - LogisticClassifier - INFO - Metrics saved to outputs/logistic/metrics/LogisticClassifier_cv_std_20250203_224928.json
2025-02-03 22:50:44,394 - LogisticClassifier - INFO - Training pipeline completed successfully!
